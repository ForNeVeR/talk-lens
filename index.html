<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Как мы разработали свой язык программирования</title>

        <link rel="stylesheet" href="node_modules/reveal.js/css/reveal.css">
        <link rel="stylesheet" href="node_modules/reveal.js/css/theme/white.css">
        <link rel="stylesheet" href="node_modules/reveal.js/lib/css/agate.css">
        <style>
            img {
                border: 0 !important;
                box-shadow: none !important;
                max-height: 500px !important;
            }
            body > .reveal > .slide-number {
                left: 8px;
                right: initial;
                font-size: 6vh;
            }
            .reveal pre code.hljs {
                max-height: 500px;
            }
            .reveal blockquote p {
                text-align: left;
            }
            .reveal h2 {
                text-transform: initial;
            }
            .title-section h2 {
                font-size: 300%;
                margin-bottom: 100px;
            }
        </style>
    </head>
    <body>
        <div class="reveal" data-separator-notes="^Notes:">
            <div class="slides">
                <section>
                <section data-markdown class="first-slide">
                    <script type="text/template">
                        ## Как мы разработали свой язык программирования
                        ---
                        <footer style="text-align: right;">
                            by: █████████ von █████
                            <img src="images/avatar.png"
                                 style="width: 1em;
                                        height: 1em;
                                        margin: 0;
                                        border: 0;
                                        box-shadow: none;
                                        vertical-align: sub;" /><br/>
                            https://github.com/ForNeVeR<br/>
                            https://fornever.me/<br/>
                            <img src="images/jetbrains.png"
                                 style="width: 2em; height: 2em; margin: 0; border: 0; box-shadow: none;" />
                            <img src="images/rider.png"
                                 style="width: 2em; height: 2em; margin: 0; border: 0; box-shadow: none;" /><br/>
                        </footer>

                        Notes:

                        Сегодня я расскажу вам про разработку своего собственного языка
                        программирования.

                        Почти каждый программист хоть раз в жизни задумывается о том, что неплохо бы
                        создать свой язык программирования. Мотивация у людей разная: кому-то не
                        дают покоя лавры создателей уже известных языков, кто-то жаждет исправить
                        все-все фатальные недостатки в том языке, на котором пишет сейчас, а кто-то,
                        как я, просто хочет повеселиться.

                        И вот, как-то раз нам с товарищем стало очень скучно, и поэтому мы решили
                        взять и написать свой язык программирования. И вот так нам в тот раз
                        повезло, что _остановить нас было некому_. Поэтому мы взяли и написали свой
                        язык программирования!
                    </script>
                </section>
                <section>
                    <h2>☭ Maintenance section ☭</h2>
                    <ul>
                        <li><a href="#" onclick="javascript:window.location.hash = 'show-notes';window.location.reload();return false;">Show slide notes</a></li>
                        <li><a href="#" onclick="javascript:window.location.search = 'print-pdf';return false;">Snter PDF mode</a></li>
                    </ul>
                </section>
            </section>
                <section data-markdown class="tralala">
                    <script type="text/template">
                        ## **LENS**: Language for Embeddable .NET Scripting

                        ```fsharp
                        using System.Drawing

                        pure fun dist:double (p1:Point p2:Point) ->
                            let x = p1.X - p2.X
                            let y = p1.Y - p2.Y
                            Math::Sqrt (x ** 2 + y ** 2)

                        let pA = new Point 1 2
                        let pB = new Point 10 20
                        print "The distance is: {0}" (dist pA pB)
                        ```

                        Notes:

                        Язык, который мы разработали, называется **LENS**: Language for Embeddable
                        .NET Scripting.

                        Как видите, выглядит достаточно нормально — как полноценный язык
                        программирования. И для его разработки не потребовалось слишком много усилий
                        — два совершенно обычных человека смогли его сделать примерно за полгода
                        неспешной работы.
                    </script>
                </section>
                <section data-markdown data-background="#11ff22" class="title-section center">
                    <script type="text/template">
                        ## LENS: Расширенный синтаксис

                        ```fsharp
                        record Store
                            Name : string
                            Stock : int

                        fun desribe:string (arr:object[]) ->
                            match arr with
                                case [] then "empty array"
                                case [x:int] when x < 10 then fmt "array with 1 small int ({0})" x
                                case [x] then "array with 1 item"
                                case [x; y] then "array with 2 items"
                                case [x; y; ...z] then fmt "array with {0}, {1} and {2} more items" x y z.Length
                        ```

                        Notes:

                        В целом синтаксис похож на язык F#, и в нём есть пара интересных
                        возможностей типа pattern matching (местами даже получше F#'ового) и record
                        types, но в основном язык просто поддерживает всё, что можно ожидать от
                        обычного языка под .NET: классы, структуры, функции, методы и прочее. Я
                        сегодня не буду особенно подробно останавливаться на особенностях самого
                        языка, а постараюсь рассказать о разработке языков программирования в целом,
                        фокусируясь на платформах типа .NET или Java Virtual Machine.
                    </script>
                </section>
                <section>
                    <h2>Заключение</h2>
                    <ol>
                        <li class="fragment">
                            Не нужно бояться нативного кода.
                        </li>
                        <li class="fragment">
                            По возможности стоит описывать код в безопасном
                            стиле.
                        </li>
                        <li class="fragment" data-markdown>
                            `StructLayout` — наш друг.
                        </li>
                        <li class="fragment">
                            Со строками следует обращаться крайне осторожно.
                        </li>
                        <li class="fragment">
                            Сохраняйте ссылки на делегаты.
                        </li>
                        <li class="fragment">
                            Пишите тесты.
                        </li>
                        <li class="fragment">
                            Можно даже писать тесты на memory layout.
                        </li>
                    </ol>
                </section>
                <section data-markdown class="center">
                    <script type="text/template">
                        ## Это конец.
                        <div style="width: 100%; text-align: left;">
                            <img src="images/the-end.svg" style="width: 35vw;"/>
                        </div>
                    </script>
                </section>
                <section data-markdown class="center">
                    <script type="text/template">
                        <small>
                            Материалы доклада доступны в репозитории:<br/>
                            https://github.com/ForNeVeR/talk-lens
                            <br/><br/>
                            Контакты автора: <br/>
                            <a href="mailto:friedrich@fornever.me">friedrich@fornever.me</a><br/>
                            https://t.me/fvnever
                        </small>
                    </script>
                </section>
            </div>
        </div>

        <script src="node_modules/reveal.js/lib/js/head.min.js"></script>
        <script src="node_modules/reveal.js/js/reveal.js"></script>

        <script>
            Reveal.initialize({
                dependencies: [
                    { src: 'node_modules/reveal.js/plugin/markdown/marked.js' },
                    { src: 'node_modules/reveal.js/plugin/markdown/markdown.js' },
                    { src: 'node_modules/reveal.js/plugin/notes/notes.js', async: true },
                    {
                        src: 'node_modules/reveal.js/plugin/highlight/highlight.js',
                        async: true,
                        callback: function() { hljs.initHighlightingOnLoad(); }
                    }
                ],
                showNotes: window.location.hash.match(/show-notes/gi),
            });
            Reveal.addEventListener('slidechanged', (event) => {
                const isFirst = event.indexh === 0;
                Reveal.configure({ slideNumber: !isFirst });
            });
        </script>
        <script>
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = 'node_modules/reveal.js/' + (
                window.location.search.match(/print-pdf/gi)
                    ? 'css/print/pdf.css'
                    : 'css/print/paper.css'
                );
            document.getElementsByTagName('head')[0].appendChild(link);
        </script>
    </body>
</html>
